$(function(){function a(a,t){i||(i=new App.PageBar({el:$("#j_pageBox"),cls:"ui_pageBar_L",totalNum:a.count,jumpTo:!1,onPage:function(a){e({pageNo:a,pageSize:t})}}))}function t(){i&&(i.destroy(),i=null)}function e(t){App.ajax({data:{call:"order.listMyOrder",pageNo:t.pageNo,pageSize:t.pageSize,status:t.status}}).done(function(e){e&&e.list&&e.count?(o.find(".j_tbdBox").html(template("orderTpl",e)),a(e,t.pageSize)):o.find(".j_tbdBox").html('<tr><td colspan="'+o.find("thead th").length+'"><p class="tc">暂无相关订单~</p></td></tr>')}).fail(function(a){App.tip(a&&a.message,"error")})}function n(){App.ajax({data:{call:"agent.getCouponVo"}}).done(function(a){a&&$(".j_couponInfo").find(".red").text(a.couponNo).end().removeClass("none")}).fail(function(a){App.tip(a&&a.message)})}var o=$(".orderCnt"),i=null;o.on("click",".j_order",function(){var a=$(this);a.hasClass("active")||(a.parent().addClass("active").siblings().removeClass("active"),e({pageNo:1,pageSize:10,status:a.data("status")}),t())}),e({pageNo:1,pageSize:10}),n()});