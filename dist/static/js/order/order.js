$(function(){function a(a,e){p||(p=new App.PageBar({el:$("#j_pageBox"),cls:"ui_pageBar_L",totalNum:a.count,jumpTo:!1,onPage:function(a){t({pageNo:a,pageSize:e})}}))}function e(){p&&(p.destroy(),p=null)}function t(e){App.ajax({data:{call:"order.listMyOrder",pageNo:e.pageNo,pageSize:e.pageSize,status:e.status}}).done(function(t){t&&t.list?(o.find(".j_tbdBox").html(template("orderTpl",t)),a(t,e.pageSize)):o.find(".j_tbdBox").html('<tr><td colspan="5"><p class="tc">暂无订单~</p></td></tr>')}).fail(function(a){App.tip(a&&a.message,"error")})}function n(){App.ajax({data:{call:"agent.getCouponVo"}}).done(function(a){a&&$(".j_couponInfo").find(".red").text(a.couponNo).end().removeClass("none")}).fail(function(a){App.tip(a&&a.message)})}var o=$(".orderCnt"),p=null;o.on("click",".j_order",function(){var a=$(this);a.hasClass("active")||(a.parent().addClass("active").siblings().removeClass("active"),t({pageNo:1,pageSize:10,status:a.data("status")}),e())}),t({pageNo:1,pageSize:10}),n()});