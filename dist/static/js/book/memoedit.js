$(function(){function n(){var n=+a.find(".j_isPacking:checked").val();n?a.find(".j_isPackingTxt").removeClass("none"):a.find(".j_isPackingTxt").addClass("none"),App.onceAjax({data:{call:"shopCart.calcOrderGoodsVoPrice",isPacking:n,goodsId:1}}).done(function(n){t.find(".j_originalPrice").text(App.formatRmb(n.originalPrice)),t.find(".j_statementPrice").text(App.formatRmb(n.statementPrice)+"元")}).fail(function(n){App.tip(n&&n.message,"error")})}function i(){var n=c.validate();if(n.FAILED)return App.tip(n.msg,"error"),!1;n.isPacking=a.find('[name="gift"]:checked').val();var i=$.extend({goodsId:1,storyId:e.v,chineseName:e.zh,pinyinName:e.py,gender:"boy"===e.sex?1:0,lead:e.v,nameInfo:JSON.stringify(App.BookData.getInstance()),call:"shopCart.add"},n);App.onceAjax({method:"POST",data:i}).done(function(){App.tip("加入购物车成功~"),setTimeout(function(){App.linkTo("/cart/cart.jsp")},1e3)}).fail(function(n){App.tip(n&&n.message,"error")})}var o=require("modules/photoUpload/index"),e=App.params(),a=$(".bookEditCnt"),t=a.find(".j_goodsPriceBox"),c=new App.FormValidator({$form:a.find(".bookEdit")});a.find(".j_pyName").text(e.py),a.find(".j_zhName").text(e.zh),new o({$container:$(".j_photoUploadDiv")}),a.on("click",".j_goEdit",function(){App.linkTo("/book/editname.jsp",e)}).on("click","#j_addToCart",function(){i()}).on("click",".j_isPacking",function(){n()}),n()});