$(function(){function e(){var e=o.validate();if(!e.FAILED){e.statementTime&&(e.statementTime=new Date(e.statementTime).getTime());var t=$.extend(r,e,{call:"admin.commitStatement",status:1});delete t._statusTxt,delete t.createTime,delete t.updateTime,App.onceAjax({method:"POST",data:t}).done(function(e){sessionStorage.setItem("BALANCE_DETAIL",JSON.stringify(e)),App.tip("结算记录更新成功")}).fail(function(e){App.tip(e&&e.message,"error")})}}function t(e){return App.onceAjax({data:{call:"admin.getAccountVo",userId:e}}).then(function(e){return e?(n(e),void i.find("#j_submit").removeClass("disable")):(App.tip("查找用户信息失败,请确认用户ID填写正确","error"),!1)},function(e){return App.tip(e&&e.message||"查找用户账户信息失败","error"),!1})}function n(e){for(var t in e)s.find('[name="'+t+'"]').val(e[t])}function a(e){n(e)}var i=$(".adminBalanceDetailCnt"),s=i.find(".balanceForm"),o=(App.params(),new App.FormValidator({$form:s})),r=sessionStorage.getItem("BALANCE_DETAIL");i.on("click","#j_submit",function(){var t=$(this);t.hasClass("disable")||e()}).on("blur",".j_userId",function(){var e=$(this),n=e.val();/^\d+$/.test(n)&&(t(n).then(function(t){t===!1&&setTimeout(function(){o.setInvalid(e,"用户ID不正确")},0)}),i.find("#j_submit").addClass("disable"))}),r&&(r=JSON.parse(r),a(r))});