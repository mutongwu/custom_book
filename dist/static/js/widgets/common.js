function formatRmb(t){return(t/100).toFixed(2)}function dateFormat(t){return App.Format.fmDate(t,"yyyy-MM-dd hh:mm:ss")}window.App||(window.App={}),App.BomHelper={isNative:function(t,e){return e in document.createElement(t)?!0:!1},getParam:function(t){var e={},i=decodeURIComponent,n=null,a=null,s=document.location.search;if(s){s=s.substring(1),n=s.split("&");for(var l=0,o=n.length;o>l;l++)a=n[l].split("="),e[a[0]]=i(a[1]);return t?e[t]:e}return null},docSize:{width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight},viewSize:{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}},App.Format={ellipsis:function(t,e){return t&&t.length>e?t.substr(0,e-3)+"...":t},htmlEncode:function(t){return t?String(t).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):t},htmlDecode:function(t){return t?String(t).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&"):t},capitalize:function(t){return t?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():t},call:function(value,fn){if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return args.unshift(value),eval(fn).apply(window,args)}return eval(fn).call(window,value)},stripTagsRE:/<\/?[^>]+>/gi,stripTags:function(t){return t?String(t).replace(this.stripTagsRE,""):t},stripScriptsRe:/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,stripScripts:function(t){return t?String(t).replace(this.stripScriptsRe,""):t},fileSize:function(t){return 1024>t?t+" bytes":1048576>t?Math.round(10*t/1024)/10+" KB":Math.round(10*t/1048576)/10+" MB"},nl2br:function(t){return void 0===t||null===t?"":t.replace(/\n/g,"<br/>")},isDate:function(t){return t&&"function"==typeof t.getFullYear},isLeapYear:function(t){var e=t.getFullYear?t.getFullYear():parseInt(t,100);return e%400===0||e%4===0&&e%100!==0?!0:!1},fmDate:function(t,e){function i(t){return t>9?t:"0"+t}return t?isNaN(t)||(t=new Date(+t)):t=new Date,e||(e="yyyy-MM-dd"),e.replace(/yyyy/,t.getFullYear()).replace(/MM/,i(t.getMonth()+1)).replace(/dd/,i(t.getDate())).replace(/hh/,i(t.getHours())).replace(/mm/,i(t.getMinutes())).replace(/ss/,i(t.getSeconds()))},parseDate:function(t,e){function i(e,i){var n=parseInt(t.substring(e,i),10);switch(a){case"y":r[0]=n;break;case"M":r[1]=n-1;break;case"d":r[2]=n;break;case"h":r[3]=n;break;case"m":r[4]=n;break;case"s":r[5]=n;break;default:throw new Error("Invalid Date.")}}var n=0,a=null,s=null,l=/^[yMdhms]$/,o=/^\d$/;if(t=t.replace(/^\s+/g,"").replace(/\s+$/,""),e=(e||"yyyy-MM-dd").replace(/^\s+/g,"").replace(/\s+$/,""),t.length!==e.length)return null;var r=[];a=e.charAt(h);var c=!0;try{for(var h=0,u=e.length;u>h;h++)if(s=e.charAt(h),l.test(s)&&o.test(t.charAt(h))){if(s===a)continue;a=s,c&&i(n,h),c=!0,n=h}else{if(s!==t.charAt(h))throw new Error("format no match.");c?i(n,h):n=h,c=!1}i(n,h)}catch(f){return console.error(f),null}return new Date(r[0],r[1],r[2],r[3]||0,r[4]||0,r[5]||0,0)}},App.FormValidator=function(t){this.init(t)},App.FormValidator.prototype={defaultCfg:{$form:null,selector:'.ui-input,.ui-textarea,.ui-select,input[type="hidden"],.ui-radio',clearInvalidFn:null,setInvalidFn:null,getLabelFn:null,invalidCls:"ui-input-error",errorTxt:"请填写正确的",numTxt:"请填写数字的",reqTxt:"不能为空",vTxt:"请填写{0}位的",minTxt:"不能少于{0}位",maxTxt:"不能大于{0}位"},PHONE:/^1[3456789]\d{9}$/,TEL:/^(0[0-9]{2,3}\-)([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/,NUM:/^\d+$/,BLANK:/^\s*$/,EMAIL:/^[\w\.\-]+@([\w\-]+\.)+[a-zA-Z]+$/,POSTCODE:/^[1-9][0-9]{5}$/,IDCARD:/^((1[1-5])|(2[1-3])|(3[1-7])|(4[1-6])|(5[0-4])|(6[1-5])|71|(8[12])|91)\d{4}((19\d{2}(0[13-9]|1[012])(0[1-9]|[12]\d|30))|(19\d{2}(0[13578]|1[02])31)|(19\d{2}02(0[1-9]|1\d|2[0-8]))|(19([13579][26]|[2468][048]|0[48])0229))\d{3}(\d|X|x)?$/,PASSPORT:/^1[45][0-9]{7}|G[0-9]{8}|P[0-9]{7}|S[0-9]{7,8}|D[0-9]+$/,URL:/^(((http|https):\/\/)?([\w\-]+\.)+[\w\-]+(\/[\w\u4e00-\u9fa5\-\.\/?\@\%\!\&=\+\~\:\#\;\,]*)?)/i,setConfig:function(t){this.config=$.extend({},this.defaultCfg,t)},init:function(t){var e=this;this.setConfig(t),this.config.$form.on("focus",this.config.selector,function(){e.clearInvalid(this)}).on("blur",this.config.selector,function(){var t=e.validateField(this);t!==!0?e.setInvalid(this,t):e.clearInvalid(this)})},destroy:function(){this.config.$form.off(),this.config=null},_getLabel:function(t){return this.config.getLabelFn?this.config.getLabelFn(t):t.attr("label")||t.closest(".ui-form-item").children(".ui-form-label").text()},_tmpl:function(t){if(1!==arguments.length)for(var e=arguments.length-1;e>0;e--)t=t.replace("{"+(e-1)+"}",arguments[e]);return t},validateField:function(t){var e=$(t);if(!t.name||t.disabled||e.hasClass("disable"))return!0;var i=this,n=t.value,a=null,s=i._getLabel(e);if(s=s.replace(/^\*/,"").replace(/[:：]$/,""),a=e.attr("vtype"),e.attr("novalidate"))return!0;if(e.attr("required")&&i.BLANK.test(n))return s+=i.config.reqTxt;if(n){var l=parseInt(e.attr("minlength")||0,10);if(l&&n.length<l)return s+=i._tmpl(i.config.minTxt,l);if(l=parseInt(e.attr("maxlength")||0,10),l>0&&n.length>l)return s+=i._tmpl(i.config.maxTxt,l);if(l=parseInt(e.attr("vlength")||0,10),l>0&&n.length!==l)return s=i._tmpl(i.config.vTxt,l)+s;if(a){var o,r=!1,c=null,h=[s];return $.each(a.split("|"),function(t,e){switch(e){case"phone":c=i.PHONE;break;case"num":c=i.NUM,o=i.config.numTxt;break;case"email":c=i.EMAIL;break;case"postcode":c=i.POSTCODE;break;case"idcard":c=i.IDCARD;break;case"passport":c=i.PASSPORT;break;case"url":c=i.URL;break;case"tel":c=i.TEL;break;default:c=null}return c&&c.test(n)?(r=!0,!1):(o=i.config.errorTxt,void(1===h.length&&h.unshift(o)))}),r||h.join("")}}return!0},clearInvalid:function(t){t=t?$(t):this.config.$form,this.config.clearInvalidFn?this.config.clearInvalidFn(t):t.is("FORM")?t.find(this.config.selector).removeClass(this.config.invalidCls).siblings(".ui-field-error").hide():t.removeClass(this.config.invalidCls).siblings(".ui-field-error").hide()},setInvalid:function(t,e){this.config.setInvalidFn?this.config.setInvalidFn($(t)):$(t).addClass(this.config.invalidCls).siblings(".ui-field-error").html(e).show()},validate:function(){var t=this,e=null,i=null,n=!0,a={},s=this.config.$form.find(this.config.selector);return s.each(function(s,l){l.name&&n===!0&&(e=$(l),n=t.validateField(l),n===!0?(t.clearInvalid(l),i=l.value,l.type&&"radio"===l.type.toLowerCase()?l.checked&&(a[l.name]=i):l.type&&"checkbox"===l.type.toLowerCase()?l.checked&&(a[l.name]="undefined"==typeof a[l.name]?i:a[l.name]+","+i):a[l.name]=i):t.setInvalid(l,n))}),n!==!0?{FAILED:!0,el:e,msg:n}:a},isEmail:function(t){return this.EMAIL.test(t)},isPhone:function(t){return this.PHONE.test(t)},isBankCard:function(t){if(null==t||""==t)return!1;if(t.length<11)return!1;if(0==/^\d+$/.test(t))return!1;var e,i=0,n=0,a=0;for(e=t.length-2;e>=0;e-=2)i=2*parseInt(t.charAt(e)),a=i%10,n+=a,i-=a,n+=i/10;for(e=t.length-3;e>=0;e-=2)i=parseInt(t.charAt(e)),n+=i;return i=n%10,0!=i&&(i=10-i),i==parseInt(t.charAt(t.length-1))}},App.LightBox=function(t){return this.init(t),this},App.LightBox.prototype={defaultCfg:{title:"提示",msg:"",cls:"",type:"alert",msgType:"warn",closable:!0,renderFn:null,confirmFn:null,cancelFn:null,timeout:1500},init:function(t){this.config=$.extend({},this.defaultCfg,t),this._initDom(),this._initEvent()},hide:function(){this.domEl.remove()},show:function(){var t=this,e=$(".ui-lightbox-mask").size(),i=+this.domEl.find(".ui-lightbox-mask").css("zIndex");return this.domEl.find(".ui-lightbox-mask").css("zIndex",i+e-1),this.domEl.find(".ui-lightbox").css("zIndex",i+e),this.domEl.show(),this.fixPos(),"tip"===this.config.type&&setTimeout(function(){t.hide()},this.config.timeout),this},fixPos:function(){var t=this.domEl.find(".ui-lightbox"),e=t.width(),i=t.height();t.css({marginLeft:-e/2,marginTop:-i/2,top:"50%",left:"50%"})},_getHd:function(){return"tip"!==this.config.type&&this.config.title?'<div class="ui-lightbox-hd">'+(this.config.closable===!0?'<a href="#" class="close">&times;</a>':"")+this.config.title+"</div>":""},_getBd:function(){var t="";switch(this.config.msgType){case"question":t="ui-lightbox-question";break;case"warn":t="ui-lightbox-warn";break;case"success":t="ui-lightbox-success";break;case"error":t="ui-lightbox-error";break;default:t="ui-lightbox-none"}return'<div class="ui-lightbox-bd '+t+'"><i class="ui-lightbox-icon"></i><div class="ui-lightbox-msg">'+this.config.msg+"</div></div>"},_getFt:function(){var t="";return("alert"===this.config.type||"confirm"===this.config.type)&&(t='<input type="button" class="ui-button" id="J_lightbox_confirm" value="确定"/>'),"confirm"===this.config.type&&(t+='<input type="button" class="ui-button ui-button-gray" id="J_lightbox_cancel" value="取消"/>'),"none"===this.config.type&&(t=""),"tip"===this.config.type?"":'<div class="ui-lightbox-ft">'+t+"</div>"},_initDom:function(){var t=['<div class="J_lightbox '+this.config.cls+'">','<table class="ui-lightbox"><tbody><tr><td>','<div class="ui-lightbox-inner">',this._getHd(),this._getBd(),this._getFt(),"</div>","</td></tr></tbody></table>","</div>"].join("");this.domEl=$(t),"tip"===this.config.type?this.domEl.find(".ui-lightbox").addClass("ui-lightbox-tip"):this.domEl.prepend('<div class="ui-lightbox-mask"></div>'),this.domEl.appendTo("body"),"function"==typeof this.config.renderFn&&this.config.renderFn(this)},_initEvent:function(){var t=this;this.domEl.on("click",".close",function(e){e.preventDefault(),t.hide()}).on("click","#J_lightbox_confirm",function(){"function"==typeof t.config.confirmFn&&t.config.confirmFn(t),t.hide()}).on("click","#J_lightbox_cancel",function(){"function"==typeof t.config.cancelFn&&t.config.cancelFn(t),t.hide()})}},$.extend(App,{confirm:function(t,e){new App.LightBox({msg:t,msgType:"question",type:"confirm",confirmFn:e}).show()},alert:function(t,e,i){2===arguments.length&&"string"==typeof e&&(i=e,e=null),new App.LightBox({msg:t,msgType:i||"warn",type:"alert",confirmFn:e}).show()},tip:function(t,e){new App.LightBox({msg:t,msgType:e||"success",type:"tip"}).show()}}),App.DatePicker=function(t){$.extend(this,{config:null,minTime:null,maxTime:null,todayDt:null,val:null,elWidth:0,elHeight:0,domEl:null}),this.init(t)},$.extend(App.DatePicker.prototype,{defaultCfg:{id:null,el:null,val:null,cls:"ui_datePicker_L",zIndex:100,hasTime:!1,format:"yyyy-MM-dd",minVal:"1000-01-01",maxVal:"9999-01-01",beforeEl:null,afterEl:null},init:function(t){this.config=$.extend({},this.defaultCfg,t),this.config.el.attr("readOnly",!0),this.initVal();var e=this;this.config.el.click(function(t){t.stopPropagation(),$(".ui_datePicker_box").hide(),e.show()})},days:[31,28,31,30,31,30,31,31,30,31,30,31,30],dayNames:["日","一","二","三","四","五","六"],_setRange:function(){var t="",e="";this.config.beforeEl&&(t=this.config.beforeEl.val(),this.maxTime=t&&t<this.config.maxVal?t:this.config.maxVal),this.config.afterEl&&(e=this.config.afterEl.val(),this.minTime=e&&e>this.config.minVal?e:this.config.minVal)},initVal:function(){this.minTime=this.config.minVal,this.maxTime=this.config.maxVal,"object"==typeof this.minTime&&this.minTime instanceof Date&&(this.minTime=App.Format.fmDate(this.minTime,this.config.format)),"object"==typeof this.maxTime&&this.maxTime instanceof Date&&(this.maxTime=App.Format.fmDate(this.maxTime,this.config.format)),this.todayDt=new Date;var t=this.config.val||this.config.el.val();t?"string"==typeof t&&(/\d+/.test(t)?t=new Date(+t):(this.config.el.val(t),t=App.Format.parseDate(t,this.config.hasTime?"yyyy-MM-dd hh:mm:ss":"yyyy-MM-dd"))):t=new Date,this.val=t,this.config.el.val(App.Format.fmDate(t,this.config.format)),this.config.id=this.config.id?this.config.id:"dt_"+String(Math.random()).substr(2)},createDay:function(t,e,i,n){t.setDate(e);var a=[],s=t.getFullYear(),l=t.getMonth();(0===t.getDay()||6===t.getDay())&&a.push("weeken"),e===i&&a.push("curr"),n&&a.push(n);var o=App.Format.fmDate(t,this.config.format);return(o<this.minTime||o>this.maxTime)&&a.push("inValid"),'<td class="ui_datePicker_td '+a.join(" ")+'" y="'+s+'" m="'+l+'">'+e+"</td>"},createDays:function(t,e,i){var n=this.days[e]+(1===e&&App.Format.isLeapYear(t)?1:0),a=new Date(t,e,i,0,0,0),s=(e+11)%12,l=0===e?t-1:t,o=this.days[s]+(1===s&&App.Format.isLeapYear(t)?1:0),r=(e+1)%12,c=11===e?t+1:t;a.setDate(1);var h=a.getDay(),u=['<tbody><tr class="ui_datePicker_tr">'],f=0;a.setFullYear(l),a.setDate(1),a.setMonth(s);for(var d=o-h+1;o>=d;d++)u.push(this.createDay(a,d,null,"preMDay"));a.setDate(1),a.setMonth(e);for(var d=1;n>=d;d++)u.push(this.createDay(a,d,i)),(d+h)%7===0&&(u.push("</tr>"),u.push('<tr class="ui_datePicker_tr">'));a.setFullYear(c),a.setDate(1),a.setMonth(r),f=42-h-n;for(var p=h+n,d=1;f>=d;d++)u.push(this.createDay(a,d,null,"nextMDay")),(d+p)%7===0&&(u.push("</tr>"),u.push('<tr class="ui_datePicker_tr">'));return u.push("</tr></tbody>"),u.join("")},createHd:function(){for(var t="",e=0;e<this.dayNames.length;e++)t+="<th>"+this.dayNames[e]+"</th>";return'<thead class="ui_datePicker_hd"><tr class="ui_datePicker_title"><th class="ui_datePicker_preYear">&lt;&lt;</th><th class="ui_datePicker_preMonth">&lt;</th><th class="ui_datePicker_curr" colspan="3"><span class="ui_datePicker_currYear">'+this.val.getFullYear()+'年</span><span  class="ui_datePicker_currMonth">'+(this.val.getMonth()+1)+'月</span></th><th class="ui_datePicker_nextMonth">&gt;</th><th class="ui_datePicker_nextYear">&gt;&gt;</th></tr><tr class="ui_datePicker_names">'+t+"</tr></thead>"},createFt:function(){return'<tfoot class="ui_datePicker_ft"><tr><td colspan="2"><span class="ui_datePicker_btn set_clear">清空</span></td><td colspan="3"><span class="ui_datePicker_btn set_today">今天</span></td><td colspan="2"><span class="ui_datePicker_btn set_ok">确定</span></td></tr></tfoot>'},createSelectDom:function(t,e,i,n){for(var a=['<select class="'+i+'">'],s=t;e>s;s++)a.push(n===s?'<option value="'+s+'" selected>'+(10>s?"0"+s:s)+"</option>":'<option value="'+s+'">'+(10>s?"0"+s:s)+"</option>");return a.push("</select>"),a.join("")},createTimeBd:function(){return'<tbody class="ui_datePicker_timeBd"><tr><td colspan="7">'+this.createSelectDom(0,24,"sel_hour",this.val.getHours())+'<span class="time_sep">:</span>'+this.createSelectDom(0,60,"sel_min",this.val.getMinutes())+'<span class="time_sep">:</span>'+this.createSelectDom(0,60,"sel_sec",this.val.getSeconds())+"</tr></tbody>"},initDom:function(){var t=this.val;this._setRange();var e=this.createHd(),i=this.createFt(),n=this.createDays(t.getFullYear(),t.getMonth(),t.getDate()),a=this.config.hasTime?this.createTimeBd():"",s=['<div class="ui_datePicker_box '+this.config.cls+'" id="'+this.config.id+'"><table>',e,n,a,i,"</table></div>"].join("");$(document.body).append(s),this.domEl=$("#"+this.config.id)},update:function(){var t=this.val.getFullYear(),e=this.val.getMonth();this._setRange();var i=this.createDays(t,e,this.val.getDate());this.domEl.find("tbody").eq(0).replaceWith(i),this.domEl.find(".ui_datePicker_currMonth").html(e+1+"月"),this.domEl.find(".ui_datePicker_currYear").html(t+"年"),this.config.hasTime&&(this.domEl.find(".sel_hour").val(this.val.getHours()),this.domEl.find(".sel_min").val(this.val.getMinutes()),this.domEl.find(".sel_sec").val(this.val.getSeconds()))},updateValue:function(t){if(this.val=t?t:new Date,this.config.hasTime&&(this.val.setHours(this.domEl.find(".sel_hour").val()),this.val.setMinutes(this.domEl.find(".sel_min").val()),this.val.setSeconds(this.domEl.find(".sel_sec").val())),t){var e=App.Format.fmDate(this.val,this.config.format);this.minTime<e&&e<this.maxTime&&this.config.el.val(App.Format.fmDate(t,this.config.format))}else this.config.el.val("")},calPosition:function(){var t=null,e={w:Math.max(App.BomHelper.docSize.width,App.BomHelper.viewSize.width),h:Math.max(App.BomHelper.docSize.height,App.BomHelper.viewSize.height)},i=this.elWidth?this.elWidth:this.domEl.outerHeight(),n=this.elHeight?this.elHeight:this.domEl.outerWidth(),a=0,s=0;return t=this.config.el.offset(),a=t.top+n>e.h?t.top-n-this.config.el.outerHeight()-2:t.top+this.config.el.outerHeight()+2,s=t.left+i>e.w?e.w-i-10:t.left,this.elWidth=i,this.elHeight=n,{top:a,left:s}},show:function(){var t=null;this.domEl?(this.update(),t=this.calPosition(),this.domEl.css({display:"block",top:t.top,left:t.left})):(this.initDom(),this.initEvent(),t=this.calPosition(),this.domEl.css({visibility:"visible",zIndex:this.config.zIndex,top:t.top,left:t.left}))},onClickFn:function(t){if(!t.hasClass("inValid"))if(t.hasClass("ui_datePicker_td"))this.val.setDate(t.html()),(t.hasClass("preMDay")||t.hasClass("nextMDay"))&&(this.val.setFullYear(t.attr("y")),this.val.setMonth(t.attr("m"))),this.updateValue(this.val),this.config.hasTime?(t.closest("tbody").find("td").removeClass("curr"),t.addClass("curr")):this.domEl.hide();else{var e=t.get(0).className;switch(e){case"ui_datePicker_preYear":this.val.setFullYear(this.val.getFullYear()-1),this.update();break;case"ui_datePicker_preMonth":this.val.setMonth(this.val.getMonth()-1),this.update();break;case"ui_datePicker_nextYear":this.val.setFullYear(this.val.getFullYear()+1),this.update();break;case"ui_datePicker_nextMonth":this.val.setMonth(this.val.getMonth()+1),this.update();break;default:if(-1!==e.indexOf("ui_datePicker_btn")){-1!==e.indexOf("set_clear")&&this.updateValue(null),-1!==e.indexOf("set_today")&&this.updateValue(this.todayDt),-1!==e.indexOf("set_ok")&&this.updateValue(this.val),this.domEl.hide();break}}}},initEvent:function(){var t=this;$(document.body).click(function(e){$.contains(t.domEl[0],e.target)||t.domEl.hide()}),this.domEl.click(function(e){var i=$(e.target);t.onClickFn(i)})}}),App.PageBar=function(t){$.extend(this,{config:{},val:0,domEl:null}),this.init(t)},$.extend(App.PageBar.prototype,{defaultCfg:{el:null,cls:"",align:"tc",total:-1,totalNum:-1,pageSize:10,maxPage:10,page:1,onPage:null,jumpTo:!0,psCustom:!1,psList:[10,20,50,100],onCust:null},tplFn:template.compile('<a href="#"  class="ui_pageBar_item {{cls}}">{{n}}</a>'),dotStr:"<span>...</span>",init:function(t){$.extend(this.config,this.defaultCfg),$.extend(!0,this.config,t),this.config.total<0&&this.config.pageSize>0&&(this.config.total=Math.ceil(this.config.totalNum/this.config.pageSize)),"string"==typeof this.config.el&&(this.config.el=$("#"+this.config.el)),this.config.el.html('<div class="ui_pageBar '+this.config.cls+'"></div>'),this.domEl=this.config.el.find(".ui_pageBar").addClass(this.config.align),this.setList(this.config.page),this.bindEvent()},addTotalItems:function(t){var e=this.config;e.totalNum+=t,e.total=Math.ceil(e.totalNum/e.pageSize)},delTotalItems:function(t){var e=this.config;e.totalNum-=t,e.total=Math.ceil(e.totalNum/e.pageSize)},setList:function(t){this.val=t;var e,i,n,a=this,s=this.tplFn,l=[],o=this.config.total,r=this.config.maxPage;if(l.push('<a href="#" class="ui_pageBar_previous" style="visibility:'+(t>1?"visible":"hidden")+'">上一页</a>'),r>=o)for(e=1;o>=e;e++)l.push(e==t?s({cls:"current",n:e}):s({n:e}));else{var c=Math.ceil((r-2)/2);if(2>=t-c){for(e=1;t>e;e++)l.push(s({n:e}));for(l.push(s({cls:"current",n:t})),e++;r>e;e++)l.push(s({n:e}));r!=o&&l.push(this.dotStr),l.push(s({n:o}))}else if(t+c+1>o)for(l.push(s({n:1})),l.push(this.dotStr),e=o-r+2;o>=e;e++)l.push(s({cls:e==t?"current":"",n:e}));else{for(l.push(s({n:1})),l.push(this.dotStr),n=1,e=t-c+1;t>e;e++)l.push(s({n:e})),n++;l.push(s({cls:"current",n:t}));var h=Math.min(r-n-2,c);for(e=t+1,i=0;h>i;i++)l.push(s({n:e})),e++;r!=o&&l.push(this.dotStr),l.push(s({n:o}))}}l.push('<a href="#" class="ui_pageBar_next" style="visibility:'+(o>t?"visible":"hidden")+'">下一页</a>');var u="<ins><form><span>共"+this.config.totalNum+"条记录</span>";if(this.config.jumpTo&&(u+=["<span>,跳到第</span>",'<input type="text" class="ui_pageBar_jumpto" >',"<span>/"+o+"页</span>",'<button type="button" class="ui_pageBar_jump">确定</button>'].join("")),u+="</form></ins>",l.push(u),this.config.psCustom){var f="",d='<dd class="{{cls}}">{{num}}{{unit}}</dd>';this.config.psList&&$.each(this.config.psList,function(t,e){f+=d.replace("{{cls}}",e===a.config.pageSize?"curr":"").replace("{{num}}",e).replace("{{unit}}","条")}),l.unshift('<a class="fr ui_pageBar_psCust"><span class="custTip">每页显示...</span><dl>'+f+"</dl></a>")}this.domEl.html(l.join(""))},updatePage:function(t){isNaN(t)||t===this.val||(t=Math.min(t,this.config.total),t=Math.max(t,1),this.setList(t),"function"==typeof this.config.onPage&&this.config.onPage.call(this,t))},bindEvent:function(){var t=this,e=this.val;this.domEl.on("click",".ui_pageBar_jump",function(){var e=$(this).siblings(".ui_pageBar_jumpto").val();e&&t.updatePage(e)}).on("keypress",".ui_pageBar_jumpto",function(e){13===e.keyCode&&t.updatePage($(this).val())}).on("click","a",function(i){var n=$(i.target);if(i.preventDefault(),n.hasClass("ui_pageBar_previous"))e=t.val-1;else if(n.hasClass("ui_pageBar_next"))e=t.val+1;else{if(!n.hasClass("ui_pageBar_item")){if(n.is("dd")){var a=parseInt(n.html(),10);return void("function"==typeof t.config.psCust&&t.config.psCust(a))}return}e=parseInt(n.html(),10)}t.updatePage(e)})},destroy:function(){this.domEl.off(),this.domEl.remove()}}),App.onceAjax=function(){var t=null;return function(e){return t||(t=App.ajax(e).always(function(){t=null})),t}}(),App.ajax=function(t){var e=new $.Deferred;return $.ajax($.extend({url:"//www.sy111.com/book/a/c.do",method:"GET",dataType:"json",cache:!1,xhrFields:{withCredentials:!0}},t)).done(function(t){t&&1==t.code||null===t.code?e.resolve(t.data):e.reject(t)}).fail(function(t){e.reject(t)}),e},App.linkTo=function(t,e){var i=t;e&&(-1===i.indexOf("?")&&(i+="?"),i+="object"==typeof e?$.param(e):e),/^(https?:|\/\/)/.test(i)||(i="/book"+i),window.location.href=i},template.helper("dateFormat",dateFormat),template.helper("priceFormat",formatRmb),template.helper("encodeURIComp",function(t){return encodeURIComponent(t)}),App.isLogin=function(){return!!(GlobalData.userId||App.User&&App.User.userId)},App.formatRmb=formatRmb;