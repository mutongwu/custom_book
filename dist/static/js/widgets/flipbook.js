!function(i){function t(i){return this.init(i),this}$.extend(t.prototype,{defaultCfg:{$el:null,curr:1,duration:1e3,collapseCover:!0,atFontCls:"at-front-cover",atBackCls:"at-back-cover"},init:function(i){this.config=$.extend({},this.defaultCfg,i),this._initDom(),this._initWH(),this._showPage(this.config.curr),this._initEvent()},_initDom:function(){this.config.$flipBook=this.config.$el.addClass(".flipBook"),this.config.$flipBook.children(".j_flipItem").each(function(){var i=$(this);i.after(i.clone())}),this.config.$flipItems=this.config.$flipBook.children(".j_flipItem"),this.config.collapseCover&&this.config.$flipBook.addClass("collapseCover")},_initWH:function(){this.config.w0=this.config.$flipItems.eq(this.config.curr).width(),this.config.h0=this.config.$flipItems.eq(this.config.curr).height(),this.config.$flipItems.css({clip:"rect(0,"+this.config.w0+"px, "+this.config.h0+"px,0)"}).filter(function(i){return i%2!==0}).addClass("evenItem")},_showPage:function(i){this._beforePageChange(i),this.config.$flipItems.eq(2*i-2).addClass("active"),this.config.$flipItems.eq(2*i-1).addClass("active"),this._pageChanged(i)},_flipBack:function(i){var t=this;if(this._beforePageChange(i)){var n=this.config.$flipItems.eq(2*i-1);n.css({width:0,left:0}).addClass("fliping");var s=this.config.$flipItems.eq(2*i-2);s.addClass("next").css({clip:"rect(0px 0px "+this.config.h0+"px 0px)"}),s.animate({clip:"rect(0px "+this.config.w0+"px "+this.config.h0+"px  0px)"},1e3,function(){t.config.$flipItems.not(function(t){return t===2*i-2||t===2*i-1}).removeClass("active"),$(this).removeClass("next").addClass("active")}),n.animate({width:this.config.w0,left:"50%"},1e3,function(){t.config.curr=i,$(this).removeClass("fliping").addClass("active"),t._pageChanged()})}},_flipForward:function(i){var t=this,n=this.config.$flipItems.eq(2*i-2);if(this._beforePageChange(i)){n.css({width:0,left:"100%"}).addClass("fliping");var s=this.config.$flipItems.eq(2*i-1);s.addClass("next").css({clip:"rect(0px "+this.config.w0+"px "+this.config.h0+"px "+this.config.w0+"px)"}),s.animate({clip:"rect(0px "+this.config.w0+"px "+this.config.h0+"px  0px)"},this.config.duration,function(){t.config.$flipItems.not(function(t){return t===2*i-2||t===2*i-1}).removeClass("active"),$(this).removeClass("next").addClass("active")}),n.animate({width:this.config.w0,left:0},this.config.duration,function(){t.config.curr=i,$(this).removeClass("fliping").addClass("active"),t._pageChanged()})}},_beforePageChange:function(i){return this.config._locked?!1:(this.config._locked=!0,1!==i&&this.config.$flipBook.removeClass(this.config.atFontCls),i!==this.config.$flipItems.length/2&&this.config.$flipBook.removeClass(this.config.atBackCls),!0)},_pageChanged:function(){this.config._locked=!1;var i=this.config.curr;1===i?this.config.$flipBook.addClass(this.config.atFontCls):i===this.config.$flipItems.length/2&&this.config.$flipBook.addClass(this.config.atBackCls),this.config.onPageTurn&&this.config.onPageTurn(i)},_initEvent:function(){var i=this;$(window).on("resize.flipBook",function(){i._initWH()}),this.config.$flipItems.click(function(){$(this).next().hasClass("active")?i.config.curr>1&&i._flipBack(i.config.curr-1):$(this).next().size()&&i._flipForward(i.config.curr+1)}).hover(function(){var t=$(this).index(),n=i.config.curr;$(this).next().hasClass("active")?n>1&&i.config.$flipItems.eq(t-2).addClass("prevNextItem"):$(this).next().size()&&!i.config.$flipBook.hasClass(i.config.atBackCls)&&i.config.$flipItems.eq(t+2).addClass("prevNextItem")},function(){i.config.$flipItems.removeClass("prevNextItem")})},turnPage:function(i){i=Math.min(Math.max(1,i),this.config.$flipItems.length/2),i>this.config.curr?this._flipForward(i):i<this.config.curr&&this._flipBack(i)},destroy:function(){$(window).off("resize.flipBook")}}),i.FlipBook=t}(window.App);