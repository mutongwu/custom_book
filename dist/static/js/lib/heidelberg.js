!function(e){if("object"==typeof module&&module.exports)require("browsernizr/test/css/transformstylepreserve3d"),require("browsernizr/test/css/transforms3d"),module.exports=e(require("jquery"),require("browsernizr"));else{var t=window.Modernizr||{csstransforms3d:!0};"boolean"!=typeof t.preserve3d&&(t.preserve3d=!0),window.Heidelberg=e(window.jQuery,t)}}(function(e,t){"use strict";function i(t,a){if(!(this instanceof i)){if(!t.length)return new i(t,a);Array.prototype.forEach.call(t,function(e){return new i(e,a)})}var r={nextButton:e(),previousButton:e(),hasSpreads:!1,canClose:!1,arrowKeys:!0,concurrentAnimations:null,limitPageTurns:!0,initialActivePage:0,onPageTurn:function(){},onSpreadSetup:function(){}};this.options=e.extend({},r,a),this.el=t instanceof e?t:e(t),this.el.attr("data-useragent",navigator.userAgent),this.init()}return i.prototype.init=function(){var i=this.el,a={},r=this.options;setTimeout(function(){i.addClass("is-ready")},0),r.hasSpreads&&this.setupSpreads();var s=r.canClose?"even":"odd",n=r.canClose?"odd":"even";a.pages=e(".Heidelberg-Page",this.el),a.pagesLeft=e(".Heidelberg-Page:nth-child("+s+")",i),a.pagesRight=e(".Heidelberg-Page:nth-child("+n+")",i);var g=1&r.initialActivePage?r.initialActivePage-1:r.initialActivePage;if(r.canClose)0!==r.initialActivePage?a.pages.eq(g).add(a.pages.eq(g+1)).addClass("is-active"):a.pages.eq(0).addClass("is-active");else{var o=e("<div />").addClass("Heidelberg-HiddenCover");i.prepend(o.clone()),i.append(o.clone()),a.pages.eq(g).add(a.pages.eq(g+1)).addClass("is-active"),0===g&&this.el.addClass("at-front-cover")}if(a.previousTrigger=a.pagesLeft.add(r.previousButton),a.nextTrigger=a.pagesRight.add(r.nextButton),a.previousTrigger.on("click",function(){this.turnPage("back")}.bind(this)),a.nextTrigger.on("click",function(){this.turnPage("forwards")}.bind(this)),"undefined"!=typeof Hammer){var d={drag_min_distance:5,swipe_velocity:.3};Hammer(a.pagesLeft,d).on("dragright",function(e){this.turnPage("back"),e.gesture.stopDetect()}.bind(this)),Hammer(a.pagesRight,d).on("dragleft",function(e){this.turnPage("forwards"),e.gesture.stopDetect()}.bind(this))}var c=37,l=39;t.csstransforms3d||(c=39,l=37),r.arrowKeys&&e(document).keydown(function(e){return e.keyCode==c?(this.turnPage("forwards"),!1):e.keyCode==l?(this.turnPage("back"),!1):void 0}.bind(this))},i.prototype.turnPage=function(i){var a=this.el,r={},s=this.options,n={},g=i;r.pages=e(".Heidelberg-Page",a),r.pagesActive=e(".Heidelberg-Page.is-active",a),r.pagesAnimating=e(".Heidelberg-Page.is-animating",a),r.children=e(".Heidelberg-Page, .Heidelberg-HiddenCover",a);var o=s.concurrentAnimations&&r.pagesAnimating.length>s.concurrentAnimations,d=!t.preserve3d&&r.pagesAnimating.length>2&&s.limitPageTurns;if(!o&&!d){s.hasSpreads?(n.activeRight=r.pagesActive.eq(1).index(),n.activeLeft=n.activeRight-1):(n.activeLeft=r.pagesActive.eq(0).index(),n.activeRight=n.activeLeft+1);var c=r.pages.first().index()==n.activeLeft&&"back"==g,l=r.pages.last().index()==n.activeRight&&"forwards"==g;if(n.activeLeft-r.pages.first().index()<=2&&"back"==g?this.el.addClass("at-front-cover"):this.el.removeClass("at-front-cover"),r.pages.last().index()-n.activeRight<=2&&"forwards"==g?this.el.addClass("at-back-cover"):this.el.removeClass("at-back-cover"),!c&&!l){if("number"==typeof i){var p=1&i,v=s.canClose?p:!p;if(n.targetRight=v?i:i+1,n.targetLeft=n.targetRight-1,n.targetLeft==n.activeLeft)return;n.targetLeft>n.activeRight?(g="forwards",n.target=n.targetLeft,n.targetSibling=n.target+1):(g="back",n.target=n.targetRight,n.targetSibling=n.target-1),s.hasSpreads||(n.target=n.target-1,n.targetSibling=n.targetSibling-1)}else n.target="forwards"==g?n.activeRight+1:n.activeLeft-1,n.targetSibling="forwards"==g?n.activeRight+2:n.activeLeft-2;s.hasSpreads||"forwards"!=g||2!=n.target||(n.target=1,n.targetSibling=2),r.pagesAnimatingOut="back"==g?r.pagesActive.first():r.pagesActive.last(),r.pagesAnimatingIn=r.children.eq(n.target),r.pagesTarget=r.pagesAnimatingIn.add(r.children.eq(n.targetSibling)),r.pagesAnimating=r.pagesAnimatingIn.add(r.pagesAnimatingOut),r.pagesActive.removeClass("is-active").addClass("was-active"),r.pagesTarget.addClass("is-active"),t.csstransforms3d&&r.pagesAnimating.addClass("is-animating"),r.pagesAnimating.on("webkitTransitionEnd oTransitionEnd msTransitionEnd transitionend",function(){r.pagesAnimating.removeClass("is-animating"),r.pagesActive.removeClass("was-active")}.bind(document)),s.onPageTurn(a,r),e(this).trigger("pageTurn.heidelberg",[a,r])}}},i.prototype.setupSpreads=function(){var t=this.el,i=this.options;e(".Heidelberg-Spread",t).each(function(){var t=e(this),i=e("<div />").addClass("Heidelberg-Page with-Spread").html(t.clone());t.after(i),t.replaceWith(i.clone())}),i.onSpreadSetup(t),e(this).trigger("spreadSetup.heidelberg",t)},i});